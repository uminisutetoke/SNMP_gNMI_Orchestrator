# snmp-telegraf.conf (最終修正版)
[agent]
  interval = "10s"
  flush_interval = "10s"
  hostname = "snmp-collector"

[[outputs.mqtt]]
  servers = ["tcp://192.168.1.1:1883"]
  topic_prefix = "telemetry/snmp"
  data_format = "influx"

# --- ここからが新しい「愚直な」設定です ---
[[inputs.snmp]]
  agents = [ "srl1:161" ]
  version = 2
  community = "public"
  name = "snmp" # measurement name

  # 取得したいデータを一つ一つ、数字(OID)で指定します
  # これらは自動的に同じインターフェースのものとしてグルーピングされます
  [[inputs.snmp.field]]
    name = "sysName"
    oid = ".1.3.6.1.2.1.1.5.0"
    is_tag = true

  # IF-MIB::ifDescr (インターフェース名)
  [[inputs.snmp.field]]
    name = "ifDescr"
    oid = ".1.3.6.1.2.1.2.2.1.2"
    is_tag = true

  # IF-MIB::ifInOctets (受信バイト数)
  [[inputs.snmp.field]]
    name = "ifInOctets"
    oid = ".1.3.6.1.2.1.2.2.1.10"

  # IF-MIB::ifOutOctets (送信バイト数)
  [[inputs.snmp.field]]
    name = "ifOutOctets"
    oid = ".1.3.6.1.2.1.2.2.1.16"
